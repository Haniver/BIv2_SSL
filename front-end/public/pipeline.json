[{"$facet": {"actual": [{"$match": {"$expr": {"$and": [{"$eq": [2021, {"$year": "$fecha"}]}, {"$eq": [12, {"$month": "$fecha"}]}, {"$eq": ["dia", {"$dayOfMonth": "$fecha"}]}]}}}, {"$group": {"_id": {"anio": {"$year": "$fecha"}, "semOMes": {"$month": "$fecha"}, "dia": {"$dayOfMonth": "$fecha"}}, "con_quejas": {"$sum": "$con_queja"}, "retrasados": {"$sum": "$retrasados"}, "cancelados": {"$sum": "$Cancelados"}, "incompletos": {"$sum": "$incompletos"}, "totales": {"$sum": "$Total_Pedidos"}}}], "anterior": [{"$match": {"$expr": {"$and": [{"$eq": [2021, {"$year": "$fecha"}]}, {"$eq": [12, {"$month": "$fecha"}]}, {"$eq": ["dia", {"$dayOfMonth": "$fecha"}]}]}}}, {"$group": {"_id": {"anio": {"$year": "$fecha"}, "semOMes": {"$month": "$fecha"}, "dia": {"$dayOfMonth": "$fecha"}}, "con_quejas": {"$sum": "$con_queja"}, "retrasados": {"$sum": "$retrasados"}, "cancelados": {"$sum": "$Cancelados"}, "incompletos": {"$sum": "$incompletos"}, "totales": {"$sum": "$Total_Pedidos"}}}]}}]